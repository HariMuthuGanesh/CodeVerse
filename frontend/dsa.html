<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Phase 2: Time Stone - DSA Challenges</title>
    <link rel="stylesheet" href="../static/css/main.css">
    <style>
        .dsa-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            padding: 2rem;
        }

        .challenge-tabs {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
            justify-content: center;
        }

        .challenge-tab {
            padding: 1rem 2rem;
            background: rgba(196, 30, 58, 0.1);
            border: 2px solid var(--accent-avengers);
            border-radius: 8px;
            color: var(--text-primary);
            font-family: 'Orbitron', sans-serif;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .challenge-tab:hover {
            background: rgba(196, 30, 58, 0.3);
            box-shadow: 0 0 15px var(--accent-avengers);
        }

        .challenge-tab.active {
            background: rgba(196, 30, 58, 0.4);
            box-shadow: 0 0 20px var(--accent-avengers);
        }

        .challenge-tab.completed {
            border-color: var(--accent-red-bright);
            background: rgba(255, 23, 68, 0.2);
        }

        .challenge-content {
            display: none;
            width: 100%;
            max-width: 900px;
        }

        .challenge-content.active {
            display: block;
        }

        .bank-container {
            display: flex;
            gap: 1rem;
            padding: 1rem;
            border-bottom: 2px solid var(--accent-avengers);
            margin-bottom: 3rem;
            background: rgba(0, 0, 0, 0.5);
            border-radius: 8px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .draggable {
            width: 50px;
            height: 50px;
            background: var(--accent-avengers);
            color: #fff;
            font-weight: bold;
            display: flex;
            justify-content: center;
            align-items: center;
            border-radius: 50%;
            cursor: grab;
            box-shadow: 0 0 10px var(--accent-avengers);
            font-family: 'Orbitron';
        }

        .draggable.dragging {
            opacity: 0.5;
            cursor: grabbing;
        }

        .tree-layout {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 2rem;
            position: relative;
        }

        .level {
            display: flex;
            gap: 4rem;
            justify-content: center;
        }

        .dropzone {
            width: 60px;
            height: 60px;
            border: 2px dashed rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: all 0.3s;
            background: rgba(0, 0, 0, 0.3);
            position: relative;
        }

        .dropzone .draggable {
            cursor: pointer;
        }

        .dropzone .draggable:hover {
            transform: scale(1.1);
            box-shadow: 0 0 20px var(--accent-red-bright);
        }

        .dropzone.drag-over {
            border-color: var(--accent-avengers);
            background: rgba(196, 30, 58, 0.2);
            transform: scale(1.1);
            box-shadow: 0 0 15px var(--accent-avengers);
        }

        .instructions {
            margin-bottom: 2rem;
            color: var(--text-secondary);
            text-align: center;
            max-width: 600px;
        }

        .progress-indicator {
            margin-bottom: 2rem;
            text-align: center;
            color: var(--accent-avengers);
            font-family: 'Orbitron', sans-serif;
        }

        #loading-overlay {
            background: rgba(0, 0, 0, 0.9);
            z-index: 2000;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 5px solid rgba(255, 255, 255, 0.1);
            border-top-color: var(--accent-avengers);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        .challenge-info {
            background: rgba(196, 30, 58, 0.1);
            border: 1px solid var(--accent-avengers);
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 2rem;
            text-align: center;
        }

        .phase2-timer {
            font-size: 2rem;
            font-family: 'Orbitron', sans-serif;
            color: var(--accent-avengers);
            text-shadow: 0 0 10px var(--accent-avengers);
            margin-bottom: 2rem;
            padding: 1rem 2rem;
            background: rgba(196, 30, 58, 0.1);
            border: 2px solid var(--accent-avengers);
            border-radius: 8px;
        }

        .phase2-timer.warning {
            color: var(--accent-red-bright);
            text-shadow: 0 0 20px var(--accent-red-bright);
            animation: pulse 1s infinite;
        }

        .phase2-timer.time-up {
            color: var(--accent-red-bright);
            text-shadow: 0 0 30px var(--accent-red-bright);
        }
    </style>
</head>

<body>

    <div class="dsa-container">
        <h2 class="cinematic-title"
            style="color: var(--accent-avengers); text-shadow: 0 0 20px var(--accent-avengers);">PHASE
            2: TIME STONE</h2>
        <p class="instructions">Master the timeline. Complete all three challenges to stabilize reality.</p>

        <div class="phase2-timer" id="phase2-timer">10:00</div>

        <div class="progress-indicator" id="progress-indicator">
            Progress: 0/3 challenges completed
        </div>

        <div class="challenge-tabs">
            <button class="challenge-tab active" onclick="showChallenge('avl')" id="tab-avl">
                Challenge 1: AVL Tree (25 pts)
            </button>
            <button class="challenge-tab" onclick="showChallenge('rb')" id="tab-rb">
                Challenge 2: Red-Black Tree (25 pts)
            </button>
        </div>



        <!-- AVL Challenge -->
        <div id="challenge-avl" class="challenge-content active">
            <div class="challenge-info">
                <h3>AVL Tree Challenge</h3>
                <p>Construct a balanced AVL tree. Balance factor must be -1, 0, or 1 for all nodes.</p>
            </div>
            <p class="instructions">Drag the nodes to construct a valid <strong>AVL Tree</strong> (self-balancing BST)
            </p>

            <div class="bank-container glass-card" id="avl-bank">
                <div class="draggable interactive" draggable="true" id="avl-node-50" data-value="50">50</div>
                <div class="draggable interactive" draggable="true" id="avl-node-30" data-value="30">30</div>
                <div class="draggable interactive" draggable="true" id="avl-node-70" data-value="70">70</div>
                <div class="draggable interactive" draggable="true" id="avl-node-20" data-value="20">20</div>
                <div class="draggable interactive" draggable="true" id="avl-node-40" data-value="40">40</div>
                <div class="draggable interactive" draggable="true" id="avl-node-60" data-value="60">60</div>
                <div class="draggable interactive" draggable="true" id="avl-node-80" data-value="80">80</div>
                <div class="draggable interactive" draggable="true" id="avl-node-10" data-value="10">10</div>
                <div class="draggable interactive" draggable="true" id="avl-node-25" data-value="25">25</div>
                <div class="draggable interactive" draggable="true" id="avl-node-35" data-value="35">35</div>
                <div class="draggable interactive" draggable="true" id="avl-node-55" data-value="55">55</div>
                <div class="draggable interactive" draggable="true" id="avl-node-65" data-value="65">65</div>
                <div class="draggable interactive" draggable="true" id="avl-node-75" data-value="75">75</div>
                <div class="draggable interactive" draggable="true" id="avl-node-90" data-value="90">90</div>
            </div>

            <div class="tree-layout" id="avl-tree">
                <div class="level">
                    <div class="dropzone" id="avl-slot-1"></div>
                </div>
                <div class="level" style="gap: 8rem;">
                    <div class="dropzone" id="avl-slot-2"></div>
                    <div class="dropzone" id="avl-slot-3"></div>
                </div>
                <div class="level" style="gap: 4rem;">
                    <div class="dropzone" id="avl-slot-4"></div>
                    <div class="dropzone" id="avl-slot-5"></div>
                    <div class="dropzone" id="avl-slot-6"></div>
                    <div class="dropzone" id="avl-slot-7"></div>
                </div>
                <div class="level" style="gap: 2rem;">
                    <div class="dropzone" id="avl-slot-8"></div>
                    <div class="dropzone" id="avl-slot-9"></div>
                    <div class="dropzone" id="avl-slot-10"></div>
                    <div class="dropzone" id="avl-slot-11"></div>
                    <div class="dropzone" id="avl-slot-12"></div>
                    <div class="dropzone" id="avl-slot-13"></div>
                    <div class="dropzone" id="avl-slot-14"></div>
                    <div class="dropzone" id="avl-slot-15"></div>
                </div>
            </div>

            <button class="btn-cyber interactive" onclick="validateAVL()"
                style="margin-top: 3rem; border-color: var(--accent-avengers); color: var(--accent-avengers);">
                VALIDATE AVL
            </button>
        </div>

        <!-- Red-Black Tree Challenge -->
        <div id="challenge-rb" class="challenge-content">
            <div class="challenge-info">
                <h3>Red-Black Tree Challenge</h3>
                <p>Color the nodes and place them correctly. Root must be BLACK. No Red-Red relationships.</p>
            </div>
            <p class="instructions">Drag nodes to construct a valid <strong>Red-Black Tree</strong>.</p>

            <!-- Bank with colored nodes. data-color attribute helps validation -->
            <div class="bank-container glass-card" id="rb-bank">
                <!-- Node Format: Value (Color) -->
                <div class="draggable interactive" draggable="true" id="rb-node-10" data-value="10" data-color="black"
                    style="background: #000; border: 2px solid var(--accent-avengers);">10</div>
                <div class="draggable interactive" draggable="true" id="rb-node-5" data-value="5" data-color="red"
                    style="background: #D00; border: 2px solid #FFF;">5</div>
                <div class="draggable interactive" draggable="true" id="rb-node-15" data-value="15" data-color="red"
                    style="background: #D00; border: 2px solid #FFF;">15</div>
                <div class="draggable interactive" draggable="true" id="rb-node-2" data-value="2" data-color="black"
                    style="background: #000; border: 2px solid var(--accent-avengers);">2</div>
                <div class="draggable interactive" draggable="true" id="rb-node-7" data-value="7" data-color="black"
                    style="background: #000; border: 2px solid var(--accent-avengers);">7</div>
                <div class="draggable interactive" draggable="true" id="rb-node-12" data-value="12" data-color="black"
                    style="background: #000; border: 2px solid var(--accent-avengers);">12</div>
                <div class="draggable interactive" draggable="true" id="rb-node-20" data-value="20" data-color="black"
                    style="background: #000; border: 2px solid var(--accent-avengers);">20</div>
            </div>

            <div class="tree-layout" id="rb-tree">
                <!-- 3 Levels for simple RB test -->
                <div class="level">
                    <div class="dropzone" id="rb-slot-1"></div>
                </div>
                <div class="level" style="gap: 8rem;">
                    <div class="dropzone" id="rb-slot-2"></div>
                    <div class="dropzone" id="rb-slot-3"></div>
                </div>
                <div class="level" style="gap: 2rem;">
                    <div class="dropzone" id="rb-slot-4"></div>
                    <div class="dropzone" id="rb-slot-5"></div>
                    <div class="dropzone" id="rb-slot-6"></div>
                    <div class="dropzone" id="rb-slot-7"></div>
                </div>
            </div>

            <button class="btn-cyber interactive" onclick="validateRB()"
                style="margin-top: 3rem; border-color: var(--accent-avengers); color: var(--accent-avengers);">
                VALIDATE RB TREE
            </button>
        </div>
    </div>

    <!-- Result Modal -->
    <div id="result-modal" class="modal-overlay">
        <div class="glass-card animate-on-scroll"
            style="text-align:center; padding: 3rem; border-color: var(--accent-avengers);">
            <h2 id="result-title" class="cinematic-title"></h2>
            <p id="result-msg" style="margin: 2rem 0; font-size: 1.2rem;"></p>
            <div id="action-area"></div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div id="loading-overlay" class="modal-overlay">
        <div class="spinner"></div>
    </div>

    <script src="../static/js/cursor.js"></script>
    <script src="../static/js/animations.js"></script>
    <script src="../static/js/state-manager.js"></script>
    <script src="../static/js/dsa-trees.js"></script>
    <script src="../static/js/dsa.js"></script>
</body>

</html>